"0","# A heatmap"
"0","# Make heatmap using relative abundances"
"0","library(Polychrome)"
"0","source(""D:/GitHub/PARAFAC4Microbiome/heatmap.2a.R"")"
"0","hclust.ward = function(x) hclust(x, method=""ward.D"")"
"0","dist.pear = function(x) as.dist(1-cor(t(x)))"
"0",""
"0","# Classical result"
"0","diffAbs = cbind(df_meta, relAbs %>% select(all_of(annotated_result$asv))) %>% as_tibble() %>% left_join(rf) %>% filter(RFgroup != 1)"
"2","Joining with `by = join_by(subject)`"
"0","RFgroups = diffAbs$RFgroup"
"0","diffAbs = diffAbs %>% select(-sample,-subject,-visit,-group,-niche,-RFgroup)"
"0",""
"0","P50 = createPalette(50,  c(""#ff0000"", ""#00ff00"", ""#0000ff"")) # red=0, green=1, blue=2"
"0","rowCols = P50[RFgroups+1]"
"0","heatmap.2a(as.matrix(diffAbs), distfun=dist.pear, hclustfun=hclust.ward, scale=""row"", trace=""none"", RowSideColors=rowCols)"
