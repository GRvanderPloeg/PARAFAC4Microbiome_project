"0","simulate<-function(mod,para, nIndiv, nTime,disper, nTaxa, nSc1, nSc2, nSc3, meta){"
"0","  "
"0","  TAXA<-setNames(data.frame(matrix(ncol = nTaxa, "
"0","                                   nrow = nIndiv*nTime)),paste0(""Taxa_"",1:nTaxa))"
"0","  "
"0","  for(i in 1:nTaxa){"
"0","    if(i<=nSc1){#Time"
"0","      k=1"
"0","    }else if(i<=nSc1+nSc2){#Group"
"0","      k=2"
"0","    }else if(i<=nSc1+nSc2+nSc3){#Time+Group+Time*Group"
"0","      k=3"
"0","    }else {#No"
"0","      k=4"
"0","    }"
"0","    count<-c()"
"0","    for(j in 1:nIndiv){"
"0","      t<-c(tsglm.sim(n=nTime, param = para[[k]], model=model, "
"0","                     xreg=matrix(c(1:nTime,"
"0","                                   rep(meta$Group[meta$Indiv==j][1],nTime),"
"0","                                   1:nTime*rep(meta$Group[meta$Indiv==j][1],nTime)),ncol=3), "
"0","                     link=""identity"","
"0","                     distr=""nbinom"", distrcoefs=c(size=1/disper))$ts)"
"0","      count<-c(count,t)"
"0","    }"
"0","    while(!any(count==0)){#At least one zero (Needed to run ZIGMM)"
"0","      count<-c()"
"0","      for(j in 1:nIndiv){"
"0","        t<-c(tsglm.sim(n=nTime, param = para[[k]], model=model, "
"0","                       xreg=matrix(c(1:nTime,rep(meta$Group[meta$Indiv==j][1],nTime),"
"0","                                     1:nTime*rep(meta$Group[meta$Indiv==j][1],nTime)),ncol=3),"
"0","                       link=""identity"","
"0","                       distr=""nbinom"", distrcoefs=c(size=1/disper))$ts)"
"0","        count<-c(count,t)"
"0","      } "
"0","    }"
"0","    TAXA[,i]<-count"
"0","  }"
"0","  "
"0","  "
"0","  return(TAXA)"
"0","}"
"0",""
"0",""
