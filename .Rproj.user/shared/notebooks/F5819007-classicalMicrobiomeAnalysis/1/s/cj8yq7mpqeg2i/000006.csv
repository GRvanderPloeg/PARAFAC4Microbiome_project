"0",""
"0","# PARAFAC result"
"0","pfacSelection = paste0(""ASV"", c(5,7,9,17,20,22,50,52,61,72,74,79,90,92,96,99,114,117,118,153,170,180))"
"0","relAbs2 = df_numeric %>% select(all_of(pfacSelection))"
"0","diffAbs = apply(relAbs2, 1, FUN=function(x){x/sum(x)}) %>% t() %>% as_tibble()"
"0","diffAbs = cbind(df_meta, diffAbs) %>% as_tibble() %>% left_join(rf) %>% filter(RFgroup != 1)"
"1","[38;5;245mJoining, by = ""subject""[39m
"
"0","RFgroups = diffAbs$RFgroup"
"0","diffAbs = diffAbs %>% select(-sample,-subject,-visit,-group,-niche,-RFgroup)"
"0",""
"0","diffAbs = diffAbs[-67,]"
"0","RFgroups = RFgroups[-67]"
"0","P50 = createPalette(50,  c(""#ff0000"", ""#00ff00"", ""#0000ff"")) # red=0, green=1, blue=2"
"0","rowCols = P50[RFgroups+1]"
"0","heatmap.2a(as.matrix(diffAbs), distfun=dist.pear, hclustfun=hclust.ward, scale=""row"", trace=""none"", RowSideColors=rowCols)"
