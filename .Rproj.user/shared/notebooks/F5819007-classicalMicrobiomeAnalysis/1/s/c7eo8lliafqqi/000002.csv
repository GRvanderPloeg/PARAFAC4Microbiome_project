"0","timepointA = 2"
"0","timepointB = 3"
"0","HOMD_mapping = read.csv(""./TIFN/homd_result.csv"") %>% as_tibble() %>% select(-X)"
"0",""
"0","df2 = df %>% filter(visit %in% c(timepointA, timepointB))"
"0","df2_meta = df2 %>% select(sample, subject, visit, group, niche)"
"0","df2_num = df2 %>% select(-sample,-subject,-visit,-group,-niche)"
"0","df2_num_filtered = df2_num[,filterMask]"
"0",""
"0","condition = df2_meta %>% select(visit) %>% pull() %>% as.factor()"
"0","dds <- DESeqDataSetFromMatrix(countData = t(df2_num_filtered),"
"0","                              colData = DataFrame(condition),"
"0","                              design = ~ condition)"
"0","dds <- DESeq(dds)"
"2","estimating size factors
"
"2","estimating dispersions
"
"2","gene-wise dispersion estimates
"
"2","mean-dispersion relationship
"
"2","final dispersion estimates
"
"2","fitting model and testing
"
"2","-- replacing outliers and refitting for 23 genes
-- DESeq argument 'minReplicatesForReplace' = 7 
-- original counts are preserved in counts(dds)
"
"2","estimating dispersions
"
"2","fitting model and testing
"
"0","result = results(dds)"
"0",""
"0","result %>% as_tibble() %>% mutate(p = -log10(padj)) %>% ggplot(aes(x=log2FoldChange,y=p)) + geom_point() + ylab(""-1*log10(padj)"")"
